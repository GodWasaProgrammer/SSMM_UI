<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="SSMM_UI.MainWindow"
		xmlns:local="clr-namespace:SSMM_UI.ViewModel" 
		xmlns:Views="clr-namespace:SSMM_UI.Views"
        x:DataType="local:MainWindowViewModel"
        Title="SSMM_UI" Width="1920" Height="1080"
        Background="{DynamicResource BackgroundColor}">
	
	<Grid>
		<Grid.ColumnDefinitions>
			<ColumnDefinition Width="250"/>
			<ColumnDefinition Width="*"/>
		</Grid.ColumnDefinitions>
		<Grid>
			<Grid.ColumnDefinitions>
				<ColumnDefinition Width="250"/>
				<ColumnDefinition Width="*"/>
			</Grid.ColumnDefinitions>

			<!-- Left sidebar + menu -->
			<DockPanel Grid.Column="0">
				<Menu DockPanel.Dock="Top">
					<MenuItem Header="Settings" Command="{Binding OpenSetting}">
					</MenuItem>
				</Menu>
				<Views:LeftSideBarView x:Name="LeftSideBar" DataContext="{Binding LeftSideBarViewModel}"/>
			</DockPanel>
		</Grid>
		<!-- Main Content Area -->
		<TabControl Grid.Column="1" Background="Transparent" BorderThickness="0">
			<TabItem Header="Stream">
				<ScrollViewer>
					<StackPanel Margin="15">
						<Border Classes="card">
							<StackPanel>
								<TextBlock Text="STREAM CONTROLS" Classes="secondary"/>
								<WrapPanel>
									<Button Content="Start Stream" Classes="success" Margin="0 0 15 0"
                                            Command="{Binding StartStreamCommand}" IsEnabled="{Binding CanStartStream}"/>
									<Button Content="Stop Streams" Classes="danger" Margin="0 0 15 0"
                                            Command="{Binding StopStreamsCommand}" IsEnabled="{Binding CanStopStream}"/>
									<Button Content="Start Receiving" Classes="danger" Margin="0 0 15 0"
                                            Command="{Binding LeftSideBarViewModel.ToggleReceivingStreamCommand}"/>
									<Button Content="Test" Command="{Binding TestYtHacksCommand}"></Button>
								</WrapPanel>

								<StackPanel Margin="0 10 0 0">
									<TextBlock Text="{Binding StreamStatusText}" Classes="secondary"/>
									<TextBlock Text="{Binding ServerStatusText}" FontWeight="SemiBold"/>
								</StackPanel>
							</StackPanel>
						</Border>

						<Border Classes="card">
							<StackPanel>
								<TextBlock Text="LOGS" Classes="secondary"/>
								<ListBox ItemsSource="{Binding LogMessages}" Height="400"
										 SelectedItem="{Binding SelectedLogItem}"
                                         FontFamily="Consolas, Courier New" BorderThickness="0"
                                         Background="{DynamicResource BorderColor}" Opacity="0.2"
                                         Foreground="{DynamicResource PrimaryTextColor}" Padding="10"/>
							</StackPanel>
						</Border>
					</StackPanel>
				</ScrollViewer>
			</TabItem>

			<TabItem Header="Stream Metadata">
				<ScrollViewer>
					<StackPanel Margin="15" Width="1000">
						<Border Classes="card">
							<!-- Använd DockPanel för att placera element bredvid varandra -->
							<DockPanel LastChildFill="True">
								<!-- SearchView dockad till vänster -->
								<Views:SearchView DataContext="{Binding SearchVM}" DockPanel.Dock="Left" Width="400"/>

								<!-- Mellanrum -->
								<Border Width="10" DockPanel.Dock="Left" Background="Transparent"/>

								<!-- Huvudinnehåll som fyller resten -->
								<StackPanel>
									<TextBlock Text="STREAM METADATA" Classes="secondary"/>
									<TextBlock Text="Title" FontWeight="SemiBold"/>
									<TextBox Text="{Binding TitleText}" FontSize="14" Padding="10"
											 BorderBrush="{DynamicResource BorderColor}" BorderThickness="1"
											 CornerRadius="4" Background="{DynamicResource CardColor}"
											 Foreground="{DynamicResource PrimaryTextColor}"/>
									<StackPanel>
										<TextBlock FontWeight="SemiBold">Category (Youtube)</TextBlock>
										<ComboBox x:Name="YoutubeCategoriesCombo"
												  ItemsSource="{Binding YoutubeVideoCategories}"
												  Width="250"
												  SelectedItem="{Binding CurrentMetadata.YouTubeCategory}"
												  Background="Transparent"
												  BorderThickness="0"
												  Padding="5">
											<ComboBox.Styles>
												<Style Selector="ComboBoxItem">
													<Setter Property="Margin" Value="0 0 5 0"/>
													<Setter Property="Padding" Value="5 3"/>
												</Style>
												<Style Selector="ComboBoxItem:selected">
													<Setter Property="Background">
														<Setter.Value>
															<SolidColorBrush Color="{DynamicResource BorderColor}" Opacity="0.3"/>
														</Setter.Value>
													</Setter>
												</Style>
											</ComboBox.Styles>
											<ComboBox.ItemTemplate>
												<DataTemplate>
													<StackPanel Margin="0 5">
														<TextBlock Text="{Binding Path=Snippet.Title}" FontWeight="SemiBold" FontSize="14"/>
													</StackPanel>
												</DataTemplate>
											</ComboBox.ItemTemplate>
										</ComboBox>
									</StackPanel>
									<Button Content="Upload Thumbnail" Classes="primary" Margin="0 10 0 0"
											Command="{Binding UploadThumbnailCommand}"/>
									<Border Width="300" Height="168" BorderBrush="{DynamicResource BorderColor}" BorderThickness="1"
											CornerRadius="4" Background="{DynamicResource BorderColor}" Opacity="0.1">
										<Image Source="{Binding ThumbnailImage}" Stretch="Uniform" Margin="5"/>
									</Border>
									
									<Button Content="Update Metadata" Classes="primary" Margin="0 10 0 0"
											Command="{Binding UpdateMetadataCommand}"/>
									<TextBlock Text="{Binding MetadataStatus}" Foreground="{DynamicResource DangerColor}"
											   Margin="0 10 0 0" TextWrapping="Wrap"/>
								</StackPanel>
							</DockPanel>
						</Border>
					</StackPanel>
				</ScrollViewer>
			</TabItem>

			<TabItem Header="Social Media AutoPoster">
				<ScrollViewer>
					<StackPanel Margin="15" Width="600">
						<Border Classes="card">
							<StackPanel>
								<CheckBox Content="X(Twitter)" IsChecked="{Binding PostToX}"/>
								<CheckBox Content="Facebook" IsChecked="{Binding PostToFacebook}"/>
								<CheckBox Content="Discord" IsChecked="{Binding PostToDiscord}"/>
							</StackPanel>
						</Border>
					</StackPanel>
				</ScrollViewer>
			</TabItem>
		</TabControl>
	</Grid>
</Window>

<!--<TabItem Header="#DEBUG">
				<StackPanel>
					<Button Click="ClearGoogleOAuthTokens">Clear Tokens</Button>
				</StackPanel>
			</TabItem>-->


